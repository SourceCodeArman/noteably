---
description: Main project rules for Noteably - AI-powered study material generator
globs: **/*
alwaysApply: true
---

# Noteably Project Overview

**Noteably** is an AI-powered platform that transforms audio/video content into structured study materials (summaries, notes, flashcards, quizzes) through a streamlined single-page flow.

## Technology Stack

- **Backend**: Django 4.2+ with Django REST Framework
- **Frontend**: Next.js 14+ (React 18+) with TypeScript
- **Database**: Supabase (PostgreSQL with RLS, real-time, built-in auth)
- **Storage**: Cloudflare R2 (S3-compatible, zero egress fees)
- **Transcription**: AssemblyAI (with real-time streaming)
- **LLM**: Google Gemini (1.5 Pro and Flash)
- **Task Queue**: Celery with Redis
- **WebSockets**: Django Channels
- **Styling**: Tailwind CSS

## Architecture Principles

- **Single-Page UX**: User uploads file → streams transcript → receives materials on same page
- **Real-Time Updates**: WebSocket-based streaming (no polling)
- **Material Selection Upfront**: User selects desired outputs at upload time
- **Simplified Providers**: No multi-provider abstraction, optimized for specific services
- **Cost-Optimized**: Use Gemini Flash for simple tasks, Pro for complex

## User Flow (7 Steps)

1. Upload file + select materials (summary, notes, flashcards, quiz)
2. Save to Cloudflare R2 + create job in Supabase
3. Establish WebSocket connection for streaming
4. Transcribe with AssemblyAI (streaming partial updates)
5. Generate materials with Gemini (tailored prompts per type)
6. Save transcript + materials to Supabase
7. Display everything on same page

## Key Features

- **Streaming Transcription**: Real-time partial transcript updates via WebSocket
- **Material Types**: Summary (3 lengths), Notes (markdown), Flashcards (Q/A), Quiz (MCQ)
- **Tiered Access**: Free users get Markdown/JSON export, Paid users get PDF export
- **Speaker Diarization**: Automatic speaker labeling
- **99+ Languages**: Automatic language detection
- **Row Level Security**: Supabase RLS ensures users only access their own data

## Reference Documents

- **PRD**: [docs/PRD.md](mdc:docs/PRD.md) - Complete product requirements
- **Implementation Plan**: Check artifacts for active tasks

## Best Practices

- Follow Django REST Framework conventions
- Use async/await for I/O operations
- Emit WebSocket events for all processing stages
- Check subscription tier before gated features (PDF export)
- Use structured logging with context
- Implement exponential backoff for API retries
